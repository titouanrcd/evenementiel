# ============================================================
# NOVA Événements - Configuration Apache pour le routeur
# ============================================================

# Activer le moteur de réécriture
RewriteEngine On

# Le RewriteBase est défini selon le chemin d'installation
# Pour /evenementiel/public/, utiliser:
RewriteBase /evenementiel/public/

# Bloquer l'accès aux fichiers sensibles
<FilesMatch "\.(env|log|sql|md|json|lock|gitignore)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Bloquer l'accès au dossier .git
RedirectMatch 404 /\.git

# Ne pas réécrire si le fichier ou dossier existe
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rediriger tout vers index.php
RewriteRule ^(.*)$ index.php [QSA,L]

# Protection contre le clickjacking
Header always set X-Frame-Options "DENY"
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Désactiver la signature du serveur
ServerSignature Off

# Désactiver le listing des répertoires
Options -Indexes

# Protection contre les injections PHP
php_flag display_errors off
php_flag log_errors on
php_value error_log ../logs/php_errors.log

# Limiter la taille des uploads
php_value upload_max_filesize 5M
php_value post_max_size 5M
