# ============================================================
# FICHIER .HTACCESS - PROTECTION DU DOSSIER UPLOADS (AMÉLIORÉ)
# ============================================================
# À placer dans le dossier /uploads/ pour bloquer l'exécution
# de scripts malveillants tout en autorisant les images.
# ============================================================

# 1. Empêcher l'exécution de TOUS les scripts (méthode la plus fiable)
# Inclut PHP, Perl, Python, ASP, etc.
<FilesMatch "\.(php|phtml|php3|php4|php5|php7|pl|py|jsp|asp|sh|cgi|exe)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# 2. Désactiver le listing des fichiers du répertoire
Options -Indexes

# 3. Empêcher le "MIME-sniffing" (navigation forcée du type de contenu)
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
</IfModule>